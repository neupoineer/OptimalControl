<?xml version="1.0"?>
<configuration>
  <connectionStrings>
    <add name="SQLSERVER" connectionString="Data Source=localhost;Initial Catalog=OptimalControl;User ID=sa;Password=bgrimm2012"  providerName="System.Data.SqlClient" />
  </connectionStrings>
  <appSettings>

    <add key="ConnectionType" value="SQLSERVER" />

    <add key="LogFile" value=""/>

    <add key ="RealTime" value ="5000"/>
    
    <add key ="LogoffMenulist" value ="menu_file_quit,menu_file_lockscreen,menu_control_run,menu_control_stop,menu_config_config,menu_config_password,menu_config_user,menu_control_history,menu_control_clear,menu_config_devices,menu_config_parameters"/>
    <add key ="LogoffTime" value ="900"/>
    
    <add key="SQLGetDevices" value="SELECT * FROM @DevicesTable"/>
    <add key="SQLInsertDevices" value="INSERT INTO @DevicesTable (Name,State,SyncState,IP,Port,UnitID) VALUES ('@Name','@State','@SyncState','@IP','@Port','@UnitID')"/>
    <add key="SQLEditDevices" value="UPDATE @DevicesTable SET Name='@Name',State='@State',SyncState='@SyncState',IP='@IP',Port='@Port',UnitID='@UnitID' WHERE Id='@Id'"/>
    <add key="SQLDeleteDevices" value="DELETE FROM @DevicesTable WHERE Id='@Id'"/>
    <add key="DevicesTable" value="Devices"/>
    
    <add key="SQLGetParameters" value="SELECT * FROM @ParametersTable WHERE DeviceID = '@DeviceID'"/>
    <add key="SQLInserttParameters" value="INSERT INTO @ParametersTable (Name,Address,Ratio,UpperLimit,LowerLimit,UltimateUpperLimit,UltimateLowerLimit,ControlPeriod,OperateDelay,DeviceID) VALUES ('@Name','@Address','@Ratio','@UpperLimit','@LowerLimit','@UltimateUpperLimit','@UltimateLowerLimit','@ControlPeriod','@OperateDelay','@DeviceID')"/>
    <add key="SQLEdittParameters" value="UPDATE @ParametersTable SET Name='@Name',Address='@Address',Ratio='@Ratio',UpperLimit='@UpperLimit',LowerLimit='@LowerLimit',UltimateUpperLimit='@UltimateUpperLimit',UltimateLowerLimit='@UltimateLowerLimit',ControlPeriod='@ControlPeriod',OperateDelay='@OperateDelay',DeviceID='@DeviceID' WHERE Id='@Id'"/>
    <add key="SQLDeletetParameters" value="DELETE FROM @ParametersTable WHERE Id='@Id'"/>
    <add key="ParametersTable" value="Parameters"/>

    <add key="SQLGetHistoryData" value="SELECT * FROM @DataTable WHERE ParameterName='@ParameterName' AND DeviceID='@DeviceID' AND Time &gt;= '@StartTime' AND Time &lt;= '@EndTime'"/>

    <add key="SQLGetHistoryData1" value="DECLARE @sql1 varchar(8000); SELECT @sql1 = ISNULL(@sql1 + '],[' , '') + [Name] FROM [@CurvesTable] GROUP BY [Name]; SET @sql1 = '[' + @sql1 + ']';"/>
    <add key="SQLGetHistoryData2" value="DECLARE @sql2 varchar(8000); SELECT @sql2 = ISNULL(@sql2 + ''',MAX([' , '') + [Name] +']) AS ''' + [Name]  FROM [@CurvesTable] GROUP BY [Name]; SET @sql2 = 'MAX([' + @sql2 + '''';"/>
    <add key="SQLGetHistoryData3" value="EXEC ('SELECT [Time] AS ''时间'',' + @sql2 + ' 	FROM (SELECT * FROM [@DataTable] WHERE [Time] &gt;= ''@StartTime'' AND [Time] &lt; ''@EndTime'') AS a PIVOT (MAX([Value]) FOR [ParameterName] IN (' + @sql1 + ')) b GROUP BY [Time] ORDER BY [Time]');"/>

    <add key="SQLSaveData0" value="INSERT INTO @DataTable (Time, ParameterName, Value, DeviceID) VALUES "/>
    <add key="SQLSaveData1" value=","/>
    <add key="SQLSaveData2" value="('@Time', '@ParameterName', '@Value', '@DeviceID')"/>
    <add key="DataTable" value="Data"/>

    <add key="SQLGetRules" value="SELECT * FROM @RulesTable"/>
    <add key="SQLInsertRules" value="INSERT INTO @RulesTable (Name,Expression,Operation,Period,State) VALUES ('@Name','@Expression','@Operation','@Period','@Enabled')"/>
    <add key="SQLEditRules" value="UPDATE @RulesTable SET Name='@Name',Expression='@Expression',Operation='@Operation',Period='@Period',State='@Enabled' WHERE Id='@Id'"/>
    <add key="SQLDeleteRules" value="DELETE FROM @RulesTable WHERE Id='@Id'"/>
    <add key="RulesTable" value="Rules"/>
    
    <add key="DCSName" value="磨机工况信息"/>
    
    <add key="ModbusRTUDeviceID" value="1"/>
    <add key="ModbusRTUPortName" value="COM1"/>
    <add key="ModbusRTUBaudrate" value="19200"/>
    <add key="ModbusRTUDatabits" value="8"/>
    <add key="ModbusRTUStopbits" value="1"/>

    <add key="MasterTitle" value="工况数据曲线"/>
    <add key="MasterTitleSize" value="12"/>
    
    <add key="CurveCount" value="12"/>
    <add key="DataListLength" value="720"/>
    <add key="CurveList" value="4,4,4"/>
    <add key="Proportion" value="3,3,2"/>

    <add key="SQLGetCurves" value="SELECT * FROM @CurvesTable"/>
    <add key="SQLInsertCurves" value="INSERT INTO @CurvesTable (Name,DeviceID,Address,LineColor,LineType,LineWidth,SymbolType,SymbolSize,XTitle,YTitle,YMax,YMin) VALUES ('@Name','@DeviceID','@Address','@LineColor','@LineType','@LineWidth','@SymbolType','@SymbolSize','@XTitle','@YTitle','@YMax','@YMin')"/>
    <add key="SQLEditCurves" value="UPDATE @CurvesTable SET Name='@Name',DeviceID='@DeviceID',Address='@Address',LineColor='@LineColor',LineType='@LineType',LineWidth='@LineWidth',SymbolType='@SymbolType',SymbolSize='@SymbolSize',XTitle='@XTitle',YTitle='@YTitle',YMax='@YMax',YMin='@YMin' WHERE Id='@Id'"/>
    <add key="SQLDeleteCurves" value="DELETE FROM @CurvesTable WHERE Id='@Id'"/>
    <add key="CurvesTable" value="Curves"/>

  </appSettings>

<startup></startup>

</configuration>
